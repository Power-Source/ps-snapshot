window.SS_UTILS={},window.SS_PAGES={},function(s){s(document).ready(function(){function e(){s("#wps-snapshot-key").addClass("show"),s("body").addClass("wps-popup-modal-active")}s(".wdpun-notice").detach().appendTo("section#header"),s.each(document.body.className.replace(/-/g,"_").split(/\s+/),function(s,e){"function"==typeof SS_PAGES[e]&&SS_PAGES[e]()}),s("#view-snapshot-key,#view-snapshot-key-2").on("click",function(t){t.preventDefault();var a=s(this),o=a.html(),r=(window.snapshot_messages||{}).working||o;if(a.is(".has-key"))return e();a.html(r),s.post(ajaxurl,{action:"snapshot-full_backup-exchange_key"}).done(function(s){return(s||{}).success?window.location.reload():e((s||{}).data)}).error(e).always(function(){a.html(o)})}),s(".wps-icon.i-close").on("click",function(e){s("#wps-snapshot-key").removeClass("show"),s("body").removeClass("wps-popup-modal-active")}),s(".wps-popup-close").on("click",function(e){s(this).parents(".wps-popup-modal").removeClass("show"),s("body").removeClass("wps-popup-modal-active")}),s(".wps-popup-modal").hasClass("show")?s("body").addClass("wps-popup-modal-active"):s("body").removeClass("wps-popup-modal-active"),s("select.bulk-action-selector-top").on("change",function(e){var t=s(this).val();s("select.bulk-action-selector-top").not(this).val(t).trigger("wpmu:change")});var t=s("#wps-snapshot-key");s("#wps-snapshot-key form").on("submit",function(e){e.preventDefault();var a=s(this).serializeArray();a.push({name:"action",value:"snapshot_save_key"}),a.push({name:"security",value:s(this).data("security")}),s(".wps-snapshot-popin-content",t).addClass("hidden"),s(".wps-snapshot-popin-content-step-2",t).removeClass("hidden"),s(".wps-snapshot-key.wpmud-box-gray",t).addClass("wps-processing"),jQuery.ajax({type:"POST",url:ajaxurl,data:a,dataType:"json",success:function(e){if(s(".wps-snapshot-key.wpmud-box-gray",t).removeClass("wps-processing"),s(".wps-snapshot-popin-content",t).addClass("hidden"),e.success){s(".wps-snapshot-popin-content-step-4",t).removeClass("hidden");var a=location.href;a+=-1===a.indexOf("?")?"?":"&",location.href=a+s.param({message:"success-snapshot-key"})}else s(".wps-snapshot-popin-content-step-3",t).removeClass("hidden")},error:function(){s(".wps-snapshot-key.wpmud-box-gray",t).removeClass("wps-processing"),s(".wps-snapshot-popin-content",t).addClass("hidden"),s(".wps-snapshot-popin-content-step-3",t).removeClass("hidden")}})}),s(".wps-message").on("click",function(e){s(this).fadeOut()}).delay(2e3).fadeOut(),s(".button-disabled").on("click",function(s){s.preventDefault()}),s(".wpmud-box-tab-title.can-toggle").on("click",function(e){e.preventDefault(),s(this).parents(".wpmud-box-tab").toggleClass("open")})})}(jQuery),function(s){window.SS_PAGES.snapshot_page_snapshot_dashboard=function(){s("#view-snapshot-key,#view-snapshot-key-2").on("click",function(){var e=s("#ss-show-apikey").html();SS_UTILS.openModal(snapshot_messages.snapshot_key,e,function(){s("#reset-api-key").on("click",function(){var e=s(this).data("url");s("<a>").attr("href",e).attr("target","_blank")[0].click()})})})}}(jQuery),function(s){window.SS_PAGES.snapshot_page_snapshot_destinations=function(){if(s("#wps-destination-delete").on("click",function(e){e.preventDefault(),s("#wps-destination-warning").addClass("show")}),s(".copy-to-clipboard").on("click",function(e){e.preventDefault();var t=s(this).data("clipboard-target"),a=s(t);a.length&&(a.select(),document.execCommand("copy"))}),s(".show-instructions").on("click",function(e){s(s(this).data("instructions")).toggle()}),"dropbox"===jQuery('[name="snapshot-destination[type]"]').val()){$form=s("#wps-destinations-wizard form"),$dropboxToken=s('[name="snapshot-destination[tokens][access][authorization_token]"]'),$submitButton=s('#wps-destinations-wizard form [type="submit"]'),$forceAuthorize=s('[name="snapshot-destination[force-authorize]"]'),$dropboxToken.on("input",function(e){s(this).val().length>0?($submitButton.val($submitButton.data("authenticate-text")),$form.attr("target",""),$forceAuthorize.val("off")):($submitButton.val($submitButton.data("get-code-text")),$form.attr("target","_blank"),$forceAuthorize.val("on"))}).trigger("input"),"on"===$forceAuthorize.val()&&$forceAuthorize.is(":checkbox")&&$forceAuthorize.is(":checked")||"on"===$forceAuthorize.val()&&$forceAuthorize.is(":hidden")?($submitButton.val($submitButton.data("get-code-text")),$form.attr("target","_blank"),$forceAuthorize.val("on")):1===$dropboxToken.length&&""!==$dropboxToken.val()?($submitButton.val($submitButton.data("authenticate-text")),$form.attr("target",""),$forceAuthorize.val("off")):($submitButton.val($submitButton.data("save-text")),$form.attr("target",""),$forceAuthorize.val("off"));var e=!1;s('[name="snapshot-destination[tokens][access][authorization_token]"]',"#wps-destination-token-checkbox").on("input",function(s){e=!0}),$forceAuthorize.filter(":checkbox").on("change",function(t){s(this).is(":checked")?($submitButton.val($submitButton.data("get-code-text")),$form.attr("target","_blank"),$forceAuthorize.val("on"),s("#wps-destination-token-checkbox").css("display","block")):(e?$submitButton.val($submitButton.data("authenticate-text")):$submitButton.val($submitButton.data("save-text")),$form.attr("target",""),$forceAuthorize.val("off"),s("#wps-destination-token-checkbox").css("display","none"))}).trigger("change")}}}(jQuery),function(s){window.SS_PAGES.snapshot_page_snapshot_settings=function(){s('[name="files"]').on("change",function(){s('[name="files"]:checked').is("#common_files")?s("#wps-settings-localdir .wpmud-box-gray").removeClass("hidden"):s("#wps-settings-localdir .wpmud-box-gray").addClass("hidden")}).change(),s("#wps-settings--error .wps-input--parent > .wps-input--checkbox > input").each(function(){s(this).on("change",function(){var e=s(this),t=e.parents(".wps-input--parent").next(".wpmud-box-gray");e.is(":checked")?t.removeClass("hidden"):t.addClass("hidden")}).change()})}}(jQuery),function(s){window.SS_PAGES.snapshot_page_snapshot_snapshot_create=function(){jQuery("input[name='frequency']").on("change",function(){"once"===jQuery("input[name='frequency']:checked").val()?(jQuery("#snapshot-immediate").attr("disabled",!1).attr("checked",!0),jQuery("#snapshot-interval").attr("disabled",!0),jQuery("div#snapshot-schedule-options-container").slideUp("fast"),jQuery("#snapshot-add-update-submit").text(jQuery("#snapshot-add-update-submit").data("title-save-and-run"))):(jQuery("#snapshot-immediate").attr("disabled",!0).attr("checked",!1),jQuery("#snapshot-interval").attr("disabled",!1),jQuery("div#snapshot-schedule-options-container").slideDown("slow"),jQuery("#checkbox-run-backup-now").is(":checked")||jQuery("#snapshot-add-update-submit").text(jQuery("#snapshot-add-update-submit").data("title-save-only")))}).change(),jQuery("select#snapshot-interval").on("change",function(){var s=jQuery(this).val(),e="";"snapshot-daily"===s||"snapshot-twicedaily"===s?e="interval-offset-daily":"snapshot-weekly"===s||"snapshot-twiceweekly"===s?e="interval-offset-weekly":"snapshot-monthly"!==s&&"snapshot-twicemonthly"!==s||(e="interval-offset-monthly"),jQuery("#interval-offset > div").hide(),e&&jQuery("."+e).show()}).change(),jQuery("#checkbox-run-backup-now").on("change",function(){s(this).is(":checked")&&"once"!==jQuery("input[name='frequency']:checked").val()?jQuery("#snapshot-add-update-submit").text(jQuery("#snapshot-add-update-submit").data("title-save-and-run")):"once"!==jQuery("input[name='frequency']:checked").val()&&jQuery("#snapshot-add-update-submit").text(jQuery("#snapshot-add-update-submit").data("title-save-only"))}).change(),jQuery("[name=snapshot-destination]").on("change",function(){"dropbox"==jQuery("[name=snapshot-destination]:checked").attr("data-destination-type")?jQuery("input#snapshot-destination-sync-mirror").attr("disabled",!1):(jQuery("input#snapshot-destination-sync-mirror").attr("disabled","disabled"),jQuery("input#snapshot-destination-sync-archive").attr("checked","checked"))}).change();var e=null,t=!1;function a(){return null!==e&&e.abort(),t=!0,jQuery("#wps-build-error").removeClass("hidden").find(".wps-auth-message p").html(snapshot_messages.snapshot_aborted),jQuery(".wpmud-box-title .wps-title-result").removeClass("hidden"),jQuery(".wpmud-box-title .wps-title-progress").addClass("hidden"),jQuery("#wps-build-progress").addClass("hidden"),!1}jQuery("#wps-show-full-log").on("click",function(s){s.preventDefault();var e=jQuery(this),t=jQuery("#wps-log");t.is(".hidden")?(e.text(e.attr("data-wps-hide-title")),t.removeClass("hidden")):(e.text(e.attr("data-wps-show-title")),t.addClass("hidden"))}),jQuery("#wps-build-error-again").on("click",function(s){s.preventDefault(),jQuery("#wps-build-error").addClass("hidden"),jQuery("#wps-build-progress").removeClass("hidden"),jQuery(".wpmud-box-title .wps-title-result").addClass("hidden"),jQuery(".wpmud-box-title .wps-title-progress").removeClass("hidden"),jQuery("form#snapshot-add-update").submit()}),jQuery("#wps-build-error-back").on("click",function(s){s.preventDefault(),jQuery("#wps-build-error").addClass("hidden"),jQuery("#wps-build-progress").removeClass("hidden"),jQuery("#snapshot-add-update").removeClass("hidden"),jQuery("#container.wps-page-builder").addClass("hidden"),jQuery(".wpmud-box-title .wps-title-result").addClass("hidden"),jQuery(".wpmud-box-title .wps-title-progress").removeClass("hidden")}),jQuery("#wps-cancel").off().on("click",function(e){e.preventDefault(),a(),s("html,body").animate({scrollTop:s("#container.wps-page-builder").offset().top},"slow")}),s("#container.wps-page-builder").off("click.abort").on("click.abort","a.snapshot-button-abort",function(e){e.preventDefault(),a(),s("html,body").animate({scrollTop:s("#container.wps-page-builder").offset().top},"slow")}),jQuery(".snapshot-tables-option, .snapshot-files-option").on("change",function(){1===jQuery("#snapshot-tables-option-none:checked").length&&1===jQuery("#snapshot-files-option-none:checked").length?(jQuery("#snapshot-ajax-error").html("<p>"+snapshot_messages.no_files_tables+"</p>").show(),jQuery("#snapshot-add-update-submit").addClass("button-disabled")):(jQuery("#snapshot-ajax-error").html("").hide(),jQuery("#snapshot-add-update-submit").removeClass("button-disabled"))}),jQuery("form#snapshot-add-update").off().on("submit",function(a){t=!1,jQuery('[id^="snapshot-item-table-"]').remove(),jQuery("#snapshot-item-file").remove();var o=[],r=jQuery("input.snapshot-files-option:checked").val(),n="archive",i="";if("none"!==r){if("all"===r);else if("selected"===r&&(jQuery("input.snapshot-backup-sub-options:checked",this).each(function(){o[o.length]=jQuery(this).attr("value")}),0===o.length))return jQuery("#snapshot-ajax-warning").html("<p>"+snapshot_messages.no_files_selected+"</p>").show(),!1;i=jQuery("textarea#snapshot-files-ignore").val(),n=jQuery("input.snapshot-destination-sync:checked").val()}var p,d=[],l=jQuery("input.snapshot-tables-option:checked").val();if("selected"===l){if(jQuery("input.snapshot-table-item:checked",this).each(function(){var s=jQuery(this).attr("value");d[d.length]=s}),0===d.length)return jQuery("#snapshot-ajax-warning").html("<p>"+snapshot_messages.no_tables_selected+"</p>").show(),!1}else"all"===l&&jQuery("input.snapshot-table-item",this).each(function(){d[d.length]=jQuery(this).attr("value")});if("none"===r&&"none"===l)return jQuery("#snapshot-ajax-error").html("<p>"+snapshot_messages.no_files_tables+"</p>").show(),!1;var u=jQuery("input#snapshot-action",this).val();"add"!==u&&"update"!==u||(p=jQuery("input#snapshot-item",this).val());var h=jQuery("input#snapshot-data-item",this).val();if(""===p)return jQuery("#snapshot-ajax-warning").html("<p>"+snapshot_messages.missing_timekey+"</p>").show(),!1;var m="once"!==jQuery("input[name=frequency]:checked",this).val()?jQuery("select#snapshot-interval",this).val():"immediate";if(!jQuery("#checkbox-run-backup-now",this).is(":checked")&&"immediate"!==m)return!0;a.preventDefault();var w=jQuery("input#snapshot-archive-count",this).val(),c=jQuery("[name=snapshot-destination]:checked",this).val(),b=jQuery("select#snapshot-destination-local",this).val(),g=jQuery("input#snapshot-destination-directory",this).val(),y=0;y=jQuery("select#snapshot-blog-id",this).length>0?jQuery("select#snapshot-blog-id",this).val():jQuery("input#snapshot-blog-id",this).val();var f,v=jQuery("input#snapshot-name",this).val(),j=jQuery("textarea#snapshot-notes",this).val();for(var Q in r=jQuery("input:radio[name=snapshot-files-option]:checked",this).val(),jQuery("#snapshot-ajax-warning").html("").hide(),jQuery("#snapshot-add-update").addClass("hidden"),d)if(d.hasOwnProperty(Q)){var C=d[Q];f=s('<tr id="snapshot-item-table-'+C+'"></tr>').append(s("#wps-log-process-template").html()).find(".wps-log-process.name").html(C).end(),jQuery("tr#wps-log-process-finish").before(f)}"all"!==r&&"selected"!==r||(f=s('<tr id="snapshot-item-file"></tr>').append(s("#wps-log-process-template").html()).find(".wps-log-process.name").html('Files: <span class="snapshot-filename" style="font-style: italic;"></span>').end(),jQuery("tr#wps-log-process-finish").before(f)),jQuery("#container.wps-page-builder").removeClass("hidden");var _=d.length+2,x=0,k=[],T=[];return function a(f,Q){var C,S;if("init"===f)C=f,S={action:"snapshot_backup_ajax","snapshot-proc-action":f,"snapshot-action":u,"snapshot-item":p,"snapshot-data-item":h,"snapshot-blog-id":y,"snapshot-name":v,"snapshot-notes":j,"snapshot-files-option":r,"snapshot-files-sections":o,"snapshot-files-ignore":i,"snapshot-tables-option":l,"snapshot-tables-array":d,"snapshot-interval":m,"snapshot-archive-count":w,"snapshot-destination":c,"snapshot-store-local":b,"snapshot-destination-directory":g,"snapshot-destination-sync":n},jQuery("[id^=snapshot-interval-offset]").each(function(){S[this.name]=this.value}),e=jQuery.ajax({type:"POST",url:ajaxurl,data:S,dataType:"json",error:function(s,e,t){!1!==s.responseText&&""!==s.responseText?(jQuery("#wps-build-error .wps-auth-message p").html(s.responseText),jQuery("#wps-build-error").removeClass("hidden"),jQuery(".wpmud-box-title .wps-title-result").removeClass("hidden"),jQuery(".wpmud-box-title .wps-title-progress").addClass("hidden"),jQuery("#wps-build-progress").addClass("hidden")):(jQuery("#wps-build-error .wps-auth-message p").html("<p>AAA "+snapshot_messages.snapshot_failed+"</p>"),jQuery("#wps-build-error").removeClass("hidden"),jQuery(".wpmud-box-title .wps-title-result").removeClass("hidden"),jQuery(".wpmud-box-title .wps-title-progress").addClass("hidden"),jQuery("#wps-build-progress").addClass("hidden"))},success:function(e){if(void 0===e||void 0===e.errorStatus)jQuery("#wps-build-error").removeClass("hidden").find(".wps-auth-message p").html("<p>BBB "+snapshot_messages.snapshot_failed+"</p>"),jQuery(".wpmud-box-title .wps-title-result").removeClass("hidden"),jQuery(".wpmud-box-title .wps-title-progress").addClass("hidden"),jQuery("#wps-build-progress").addClass("hidden");else if(!1!==e.errorStatus)void 0===e.errorText?(jQuery("#wps-build-error").removeClass("hidden").find(".wps-auth-message p").html("<p>CCC "+snapshot_messages.snapshot_failed+"</p>"),jQuery(".wpmud-box-title .wps-title-result").removeClass("hidden"),jQuery(".wpmud-box-title .wps-title-progress").addClass("hidden"),jQuery("#wps-build-progress").addClass("hidden")):(jQuery("#snapshot-ajax-error").append(e.errorText),jQuery("#wps-build-error").removeClass("hidden"),jQuery(".wpmud-box-title .wps-title-result").removeClass("hidden"),jQuery(".wpmud-box-title .wps-title-progress").addClass("hidden"),jQuery("#wps-build-progress").addClass("hidden"));else if(!1===e.errorStatus||!1===t){var o=f;jQuery("#container.wps-page-builder #wps-log-process-init .wps-loading-status .wps-loading-bar span").width("100%"),jQuery("#container.wps-page-builder #wps-log-process-init .wps-loading-status .wps-loading-number").html("100%"),jQuery("#container.wps-page-builder #wps-log-process-init .wps-loading-status .wps-loading-bar .wps-loader").addClass("done"),jQuery("#container.wps-page-builder #wps-log-process-init .wps-loading-status").removeClass("wps-spinner"),jQuery("#container.wps-page-builder #wps-log-process-init .snapshot-button-abort").addClass("hidden"),x++;var r=Math.min(100,Math.round(100*x/_));if(jQuery("#wps-build-progress .wps-total-status .wps-loading-number").html(r+"%"),jQuery("#wps-build-progress .wps-total-status .wps-loading-bar span").width(r+"%"),!1===t){if(void 0!==e.files_data&&(T=e.files_data,_+=T.length),void 0!==e.table_data){k=e.table_data;var n=JSON.stringify(e.table_data);if(n)for(var i in d)if(d.hasOwnProperty(i)){o=d[i];-1===n.indexOf(o)&&s("#snapshot-item-table-"+o).remove()}a("table",0)}void 0!==e.MEMORY&&(void 0!==e.MEMORY.memory_limit&&jQuery("#snapshot-memory-info").find(".log-memory.number").html(e.MEMORY.memory_limit),void 0!==e.MEMORY.memory_usage_current&&jQuery("#snapshot-memory-info .log-usage.number").html(e.MEMORY.memory_usage_current),void 0!==e.MEMORY.memory_usage_peak&&jQuery("#snapshot-memory-info .log-peak.number").html(e.MEMORY.memory_usage_peak))}}}});else if("table"===f){var M=parseInt(Q),E=M+1;if(E>k.length)return void(T.length>0?a("file",0):a("finish",0));var A=k[M];C=A.table_name,jQuery("#container.wps-page-builder #snapshot-item-table-"+C+" a.snapshot-button-abort").removeClass("hidden"),jQuery("#container.wps-page-builder #snapshot-item-table-"+C+" .wps-spinner").removeClass("hidden"),S={action:"snapshot_backup_ajax","snapshot-proc-action":f,"snapshot-action":u,"snapshot-item":p,"snapshot-data-item":h,"snapshot-blog-id":y,"snapshot-table-data-idx":M},e=jQuery.ajax({type:"POST",url:ajaxurl,data:S,dataType:"json",error:function(s,e,t){!1!==s.responseText&&""!==s.responseText?(jQuery("#wps-build-error .wps-auth-message p").html(s.responseText),jQuery("#wps-build-error").removeClass("hidden"),jQuery(".wpmud-box-title .wps-title-result").removeClass("hidden"),jQuery(".wpmud-box-title .wps-title-progress").addClass("hidden"),jQuery("#wps-build-progress").addClass("hidden")):(jQuery("#wps-build-error .wps-auth-message p").html("<p>"+snapshot_messages.snapshot_failed+"</p>"),jQuery("#wps-build-error").removeClass("hidden"),jQuery(".wpmud-box-title .wps-title-result").removeClass("hidden"),jQuery(".wpmud-box-title .wps-title-progress").addClass("hidden"),jQuery("#wps-build-progress").addClass("hidden"))},success:function(s){if(void 0===s||void 0===s.errorStatus)jQuery("#wps-build-error").removeClass("hidden").find(".wps-auth-message p").html("<p>"+snapshot_messages.snapshot_failed+"</p>"),jQuery(".wpmud-box-title .wps-title-result").removeClass("hidden"),jQuery(".wpmud-box-title .wps-title-progress").addClass("hidden"),jQuery("#wps-build-progress").addClass("hidden");else if(!1!==s.errorStatus)void 0===s.errorText?(jQuery("#wps-build-error").removeClass("hidden").find(".wps-auth-message p").html("<p>"+snapshot_messages.snapshot_failed+"</p>"),jQuery(".wpmud-box-title .wps-title-result").removeClass("hidden"),jQuery(".wpmud-box-title .wps-title-progress").addClass("hidden"),jQuery("#wps-build-progress").addClass("hidden")):(jQuery("#snapshot-ajax-error").append(s.errorText),jQuery("#wps-build-error").removeClass("hidden"),jQuery(".wpmud-box-title .wps-title-result").removeClass("hidden"),jQuery(".wpmud-box-title .wps-title-progress").addClass("hidden"),jQuery("#wps-build-progress").addClass("hidden"));else if(!1===s.errorStatus||!1===t){if(void 0===s.table_data)void 0!==s.errorText?(jQuery("#snapshot-ajax-error").append(s.errorText),jQuery("#wps-build-error").removeClass("hidden"),jQuery(".wpmud-box-title .wps-title-result").removeClass("hidden"),jQuery(".wpmud-box-title .wps-title-progress").addClass("hidden"),jQuery("#wps-build-progress").addClass("hidden")):(jQuery("#wps-build-error .wps-auth-message p").html("<p>"+snapshot_messages.snapshot_failed+"</p>"),jQuery("#wps-build-error").removeClass("hidden"),jQuery(".wpmud-box-title .wps-title-result").removeClass("hidden"),jQuery(".wpmud-box-title .wps-title-progress").addClass("hidden"),jQuery("#wps-build-progress").addClass("hidden"));else{var e;A=s.table_data;var o=parseInt(A.rows_start)+parseInt(A.rows_end);if(o>0?(e=Math.ceil(o/A.rows_total*100),jQuery("#container.wps-page-builder #snapshot-item-table-"+A.table_name+" .wps-loading-status .wps-loading-bar span").width(e+"%"),jQuery("#container.wps-page-builder #snapshot-item-table-"+A.table_name+" .wps-loading-status .wps-loading-number").html(e+"%")):(e=100,jQuery("#container.wps-page-builder #snapshot-item-table-"+A.table_name+" .wps-loading-status .wps-loading-bar span").width(e+"%"),jQuery("#container.wps-page-builder #snapshot-item-table-"+A.table_name+" .wps-loading-status .wps-loading-number").html(e+"%")),100===e){jQuery("#container.wps-page-builder #snapshot-item-table-"+A.table_name+" .snapshot-button-abort").hide(),jQuery("#container.wps-page-builder #snapshot-item-table-"+A.table_name+" .wps-spinner").hide(),jQuery("#container.wps-page-builder #snapshot-item-table-"+A.table_name+" .wps-loading-status .wps-loading-bar .wps-loader").addClass("done"),x++;var r=Math.min(100,Math.ceil(100*x/_));jQuery("#wps-build-progress .wps-total-status .wps-loading-number").html(r+"%"),jQuery("#wps-build-progress .wps-total-status .wps-loading-bar span").width(r+"%")}void 0!==s.MEMORY&&(void 0!==s.MEMORY.memory_limit&&jQuery("#snapshot-memory-info span.memory-limit").html(s.MEMORY.memory_limit),void 0!==s.MEMORY.memory_usage_current&&jQuery("#snapshot-memory-info span.memory-usage").html(s.MEMORY.memory_usage_current),void 0!==s.MEMORY.memory_usage_peak&&jQuery("#snapshot-memory-info span.memory-peak").html(s.MEMORY.memory_usage_peak))}a("table",E)}}})}else if("file"===f){var O=parseInt(Q),$=O+1;if(C=f,$>T.length)return a("finish",0),!1;var I=T[O];jQuery("#snapshot-item-"+C+" .snapshot-filename").html(": "+I),jQuery("#container.wps-page-builder #snapshot-item-"+C+" a.snapshot-button-abort").removeClass("hidden"),jQuery("#container.wps-page-builder #snapshot-item-"+C+" .wps-spinner").removeClass("hidden"),S={action:"snapshot_backup_ajax","snapshot-proc-action":f,"snapshot-action":u,"snapshot-item":p,"snapshot-data-item":h,"snapshot-blog-id":y,"snapshot-file-data-key":I},e=jQuery.ajax({type:"POST",url:ajaxurl,data:S,dataType:"json",error:function(s,e,t){!1!==s.responseText&&""!==s.responseText?(jQuery("#wps-build-error .wps-auth-message p").html(s.responseText),jQuery("#wps-build-error").removeClass("hidden"),jQuery(".wpmud-box-title .wps-title-result").removeClass("hidden"),jQuery(".wpmud-box-title .wps-title-progress").addClass("hidden"),jQuery("#wps-build-progress").addClass("hidden")):(jQuery("#wps-build-error .wps-auth-message p").html("<p>"+snapshot_messages.snapshot_failed+"</p>"),jQuery("#wps-build-error").removeClass("hidden"),jQuery(".wpmud-box-title .wps-title-result").removeClass("hidden"),jQuery(".wpmud-box-title .wps-title-progress").addClass("hidden"),jQuery("#wps-build-progress").addClass("hidden"))},success:function(s){if(void 0===s||void 0===s.errorStatus)jQuery("#wps-build-error").removeClass("hidden").find(".wps-auth-message p").html("<p>"+snapshot_messages.snapshot_failed+"</p>"),jQuery(".wpmud-box-title .wps-title-result").removeClass("hidden"),jQuery(".wpmud-box-title .wps-title-progress").addClass("hidden"),jQuery("#wps-build-progress").addClass("hidden");else if(!1!==s.errorStatus)void 0===s.errorText?(jQuery("#wps-build-error").removeClass("hidden").find(".wps-auth-message p").html("<p>"+snapshot_messages.snapshot_failed+"</p>"),jQuery(".wpmud-box-title .wps-title-result").removeClass("hidden"),jQuery(".wpmud-box-title .wps-title-progress").addClass("hidden"),jQuery("#wps-build-progress").addClass("hidden")):(jQuery("#snapshot-ajax-error").append(s.errorText),jQuery("#wps-build-error").removeClass("hidden"),jQuery(".wpmud-box-title .wps-title-result").removeClass("hidden"),jQuery(".wpmud-box-title .wps-title-progress").addClass("hidden"),jQuery("#wps-build-progress").addClass("hidden"));else if(!1===s.errorStatus||!1===t){var e;if($<T.length)e=Math.ceil($/T.length*100),jQuery("#container.wps-page-builder #snapshot-item-"+C+" .wps-loading-status .wps-loading-bar span").width(e+"%"),jQuery("#container.wps-page-builder #snapshot-item-"+C+" .wps-loading-status .wps-loading-number").html(e+"%");else{x++;var o=Math.min(100,Math.ceil(100*x/_));jQuery("#wps-build-progress .wps-total-status .wps-loading-number").html(o+"%"),jQuery("#wps-build-progress .wps-total-status .wps-loading-bar span").width(o+"%"),e=100,jQuery("#container.wps-page-builder #snapshot-item-"+C+" .wps-loading-status .wps-loading-bar span").width(e+"%"),jQuery("#container.wps-page-builder #snapshot-item-"+C+" .wps-loading-status .wps-loading-number").html(e+"%"),jQuery("#container.wps-page-builder #snapshot-item-"+C+" .wps-loading-status .wps-loading-bar .wps-loader").addClass("done")}100==e&&(jQuery("#container.wps-page-builder #snapshot-item-"+C+" .snapshot-button-abort").hide(),jQuery("#container.wps-page-builder #snapshot-item-"+C+" .wps-spinner").hide(),jQuery("#snapshot-item-"+C+" .snapshot-filename").html("")),void 0!==s.MEMORY&&(void 0!==s.MEMORY.memory_limit&&jQuery("#snapshot-memory-info span.memory-limit").html(s.MEMORY.memory_limit),void 0!==s.MEMORY.memory_usage_current&&jQuery("#snapshot-memory-info span.memory-usage").html(s.MEMORY.memory_usage_current),void 0!==s.MEMORY.memory_usage_peak&&jQuery("#snapshot-memory-info span.memory-peak").html(s.MEMORY.memory_usage_peak)),a("file",$)}}})}else if("finish"==f){C=f,jQuery("#container.wps-page-builder #snapshot-item-table-"+C+" .wps-loading-status .wps-loading-bar span").width("0%"),jQuery("#container.wps-page-builder #snapshot-item-table-"+C+" .wps-loading-status .wps-loading-number").html("0%");var R=jQuery("#container.wps-page-builder #snapshot-item-table-"+C+" .snapshot-text").html();jQuery("#container.wps-page-builder #snapshot-item-table-"+C+" .snapshot-text").html(R+" (creating zip archive of tables)"),S={action:"snapshot_backup_ajax","snapshot-proc-action":f,"snapshot-action":u,"snapshot-item":p,"snapshot-data-item":h,"snapshot-blog-id":y},e=jQuery.ajax({type:"POST",url:ajaxurl,data:S,dataType:"json",error:function(s,e,t){!1!==s.responseText&&""!==s.responseText?(jQuery("#wps-build-error .wps-auth-message p").html(s.responseText),jQuery("#wps-build-error").removeClass("hidden"),jQuery(".wpmud-box-title .wps-title-result").removeClass("hidden"),jQuery(".wpmud-box-title .wps-title-progress").addClass("hidden"),jQuery("#wps-build-progress").addClass("hidden")):(jQuery("#wps-build-error").removeClass("hidden").find(".wps-auth-message p").html("<p>"+snapshot_messages.snapshot_failed+"</p>"),jQuery(".wpmud-box-title .wps-title-result").removeClass("hidden"),jQuery(".wpmud-box-title .wps-title-progress").addClass("hidden"),jQuery("#wps-build-progress").addClass("hidden"))},success:function(s){if(void 0===s||void 0===s.errorStatus)jQuery("#wps-build-error").removeClass("hidden").find(".wps-auth-message p").html("<p>"+snapshot_messages.snapshot_failed+"</p>"),jQuery(".wpmud-box-title .wps-title-result").removeClass("hidden"),jQuery(".wpmud-box-title .wps-title-progress").addClass("hidden"),jQuery("#wps-build-progress").addClass("hidden");else if(!1!==s.errorStatus)void 0===s.errorText?(jQuery("#wps-build-error").removeClass("hidden").find(".wps-auth-message p").html("<p>"+snapshot_messages.snapshot_failed+"</p>"),jQuery(".wpmud-box-title .wps-title-result").removeClass("hidden"),jQuery(".wpmud-box-title .wps-title-progress").addClass("hidden"),jQuery("#wps-build-progress").addClass("hidden")):(jQuery("#snapshot-ajax-error").append(s.errorText),jQuery("#wps-build-error").removeClass("hidden"),jQuery(".wpmud-box-title .wps-title-result").removeClass("hidden"),jQuery(".wpmud-box-title .wps-title-progress").addClass("hidden"),jQuery("#wps-build-progress").addClass("hidden"));else if(!1===s.errorStatus||!1===t){x++;var e=Math.min(100,Math.ceil(100*x/_));jQuery("#wps-build-progress .wps-total-status .wps-loading-number").html(e+"%"),jQuery("#wps-build-progress .wps-total-status .wps-loading-bar span").width(e+"%");jQuery("#container.wps-page-builder #wps-log-process-finish .wps-loading-status .wps-loading-bar span").width("100%"),jQuery("#container.wps-page-builder #wps-log-process-finish .wps-loading-status .wps-loading-number").html("100%"),jQuery("#container.wps-page-builder #wps-log-process-finish .wps-loading-status .wps-loading-bar .wps-loader").addClass("done"),jQuery("#container.wps-page-builder #wps-log-process-finish .wps-loading-status").removeClass("wps-spinner"),void 0!==s.MEMORY&&(void 0!==s.MEMORY.memory_limit&&jQuery("#snapshot-memory-info span.memory-limit").html(s.MEMORY.memory_limit),void 0!==s.MEMORY.memory_usage_current&&jQuery("#snapshot-memory-info span.memory-usage").html(s.MEMORY.memory_usage_current),void 0!==s.MEMORY.memory_usage_peak&&jQuery("#snapshot-memory-info span.memory-peak").html(s.MEMORY.memory_usage_peak)),void 0!==s.responseText&&(jQuery("#wps-build-success").removeClass("hidden").find(".wps-auth-message.success").html("<p>"+s.responseText+"</p>"),jQuery("#wps-build-success-view").attr("href",jQuery("#wps-build-success .wps-auth-message.success").find("a").attr("href")),jQuery("#wps-build-error").addClass("hidden"),jQuery("#wps-build-progress").addClass("hidden"))}}})}}("init",0),!0})}}(jQuery),function(s){window.SS_PAGES.snapshot_page_snapshot_snapshots_restore=function(){var e=null,t=!1;function a(){return null!==e&&e.abort(),t=!0,s("#wps-build-error").removeClass("hidden").find(".wps-auth-message p").html(snapshot_messages.restore_aborted),s(".wpmud-box-title .wps-title-result").removeClass("hidden"),s(".wpmud-box-title .wps-title-progress").addClass("hidden"),s("#wps-build-progress").addClass("hidden"),!1}s("#wps-show-full-log").on("click",function(e){e.preventDefault(),s("#wps-log").toggle();var t=s(this),a="data-wps-"+(s("#wps-log").is(":visible")?"hide":"show")+"-title";t.text(t.attr(a))}),s("#wps-build-error-again").on("click",function(e){e.preventDefault(),s("#wps-build-error").addClass("hidden"),s("#wps-build-progress").removeClass("hidden"),s(".wpmud-box-title .wps-title-result").addClass("hidden"),s(".wpmud-box-title .wps-title-progress").removeClass("hidden"),s("form#snapshot-edit-restore").submit()}),s("#wps-build-error-back").on("click",function(e){e.preventDefault(),s("#wps-build-error").addClass("hidden"),s("#wps-build-progress").removeClass("hidden"),s("#snapshot-edit-restore").removeClass("hidden"),s("#container.wps-page-builder").addClass("hidden"),s(".wpmud-box-title .wps-title-result").addClass("hidden"),s(".wpmud-box-title .wps-title-progress").removeClass("hidden")}),s("#wps-cancel").off().on("click",function(s){s.preventDefault(),a()}),s("form#snapshot-edit-restore").off().on("submit",function(){var o=s('input[name="item"]').val(),r=s('input[name="snapshot-blog-id-search"]').val(),n=s("input#snapshot-restore-option-plugins",this).attr("checked");n="checked"===n?"yes":"no";var i=s('input[name="restore-option-theme"]:checked',this).val(),p=[],d=s("input.snapshot-files-option:checked").val();"all"==d||"selected"==d&&(s("input.snapshot-backup-sub-options:checked",this).each(function(){var e=s(this).attr("value");p[p.length]=e}),0===p.length&&(d="all"));var l=[],u=s("input.snapshot-tables-option:checked").val(),h=s("input#snapshot-blog-id").val();"selected"===u?(s("input.snapshot-table-item:checked",this).each(function(){l[l.length]=s(this).attr("value")}),0===l.length&&(u="all")):"all"===u&&s("input.snapshot-table-item",this).each(function(){l[l.length]=s(this).attr("value")});var m=l.length+2,w=0;s("#snapshot-edit-restore").addClass("hidden"),s("#snapshot-ajax-warning").html(""),s("#snapshot-ajax-warning").hide(),s("#container.wps-page-builder").removeClass("hidden");var c=[],b=[],g=s('input:radio[name="snapshot-restore-file"]').val();return function y(f,v){var j,Q,C;if("init"===f){var _='<div class="snapshot-item" id="snapshot-item-table-'+(j=f)+'"><div class="progress"><div class="percent">0%</div><div class="bar" style="width: 0px;"></div></div><button style="display: none;" class="snapshot-button-abort">Abort</button><div class="snapshot-text">Snapshot determining tables/files to restore</div></div>';s("#snapshot-progress-bar-container").append(_),s("#snapshot-progress-bar-container #snapshot-item-table-"+j+" .progress .bar").width("0%"),s("#snapshot-progress-bar-container #snapshot-item-table-"+j+" .progress .percent").html("0%"),s("#snapshot-progress-bar-container #snapshot-item-table-"+j+" .snapshot-button-abort").show(),s("#snapshot-progress-bar-container #snapshot-item-table-"+j+" button.snapshot-button-abort").on("click",function(){a()}),Q={action:"snapshot_restore_ajax",snapshot_action:f,item_key:o,item_data:g,"snapshot-blog-id":h,"snapshot-files-option":d,"snapshot-files-sections":p,"snapshot-tables-option":u,"snapshot-tables-array":l,snapshot_blog_search:r},e=s.ajax({type:"POST",url:ajaxurl,data:Q,dataType:"json",error:function(e,t,a){!1!==e.responseText&&""!==e.responseText?(s("#wps-build-error").removeClass("hidden").find(".wps-auth-message p").html(e.responseText),s(".wpmud-box-title .wps-title-result").removeClass("hidden"),s(".wpmud-box-title .wps-title-progress").addClass("hidden"),s("#wps-build-progress").addClass("hidden")):(s("#wps-build-error").removeClass("hidden").find(".wps-auth-message p").html("<p>"+snapshot_messages.snapshot_failed+"</p>"),s(".wpmud-box-title .wps-title-progress").addClass("hidden"),s(".wpmud-box-title .wps-title-result").removeClass("hidden"),s("#wps-build-progress").addClass("hidden"))},success:function(e){var a;if(null!==e)if(void 0!==e.errorStatus)if(!1===e.errorStatus){if(!1===t){var o="init";s("#container.wps-page-builder #wps-log-process-init .wps-loading-status .wps-loading-bar span").width("100%"),s("#container.wps-page-builder #wps-log-process-init .wps-loading-status .wps-loading-number").html("100%"),s("#container.wps-page-builder #wps-log-process-init .wps-loading-status .wps-loading-bar .wps-loader").addClass("done"),s("#container.wps-page-builder #wps-log-process-init .snapshot-button-abort").addClass("hidden"),w++;var r=Math.min(100,Math.round(100*w/m));if(s("#wps-build-progress .wps-total-status .wps-loading-number").html(r+"%"),s("#wps-build-progress .wps-total-status .wps-loading-bar span").width(r+"%"),void 0!==e.MANIFEST.TABLES&&Object.keys(e.MANIFEST.TABLES).length){for(o in e.MANIFEST.TABLES)if(e.MANIFEST.TABLES.hasOwnProperty(o)){var n=e.MANIFEST.TABLES[o];a=s('<tr id="snapshot-item-table-'+n.table_name+'"></tr>').append(s("#wps-log-process-template").html()).find(".wps-log-process.name").html(n.label).end(),s("tr#wps-log-process-finish").before(a)}c=e.MANIFEST["TABLES-DATA"]}void 0!==e.MANIFEST["FILES-DATA"]&&Object.keys(e.MANIFEST["FILES-DATA"]).length&&(b=e.MANIFEST["FILES-DATA"],a=s('<tr id="snapshot-item-file"></tr>').append(s("#wps-log-process-template").html()).find(".wps-log-process.name").html('Files: <span class="snapshot-filename" style="font-style: italic;"></span>').end(),s("tr#wps-log-process-finish").before(a)),y("table",0)}}else void 0!==e.errorText&&(s("#wps-build-error .wps-auth-message p").html(e.errorText),s("#wps-build-error").removeClass("hidden"),s(".wpmud-box-title .wps-title-result").removeClass("hidden"),s(".wpmud-box-title .wps-title-progress").addClass("hidden"),s("#wps-build-progress").addClass("hidden"));else s("#wps-build-error .wps-auth-message p").html("<p>"+snapshot_messages.snapshot_failed+"</p>"),s("#wps-build-error").removeClass("hidden"),s(".wpmud-box-title .wps-title-result").removeClass("hidden"),s(".wpmud-box-title .wps-title-progress").addClass("hidden"),s("#wps-build-progress").addClass("hidden");else s("#wps-build-error .wps-auth-message p").html("<p>"+snapshot_messages.snapshot_failed+"</p>"),s("#wps-build-error").removeClass("hidden"),s(".wpmud-box-title .wps-title-result").removeClass("hidden"),s(".wpmud-box-title .wps-title-progress").addClass("hidden"),s("#wps-build-progress").addClass("hidden")}})}else if("table"===f){var x=parseInt(v),k=x+1;if(k>c.length)return void(b.length>0?y("file",0):y("finish",0));var T=c[x];j=T.table_name,s("#snapshot-progress-bar-container #snapshot-item-table-"+j+" button.snapshot-button-abort").show().on("click",function(){a()}),Q={action:"snapshot_restore_ajax",snapshot_action:f,item_key:o,item_data:g,"snapshot-blog-id":h,snapshot_table:j,table_data:T,snapshot_blog_search:r},e=s.ajax({type:"POST",url:ajaxurl,data:Q,timeout:6e5,dataType:"json",error:function(e,t,a){!1!==e.responseText&&""!==e.responseText?(s("#wps-build-error .wps-auth-message p").html(e.responseText),s("#wps-build-error").removeClass("hidden"),s(".wpmud-box-title .wps-title-result").removeClass("hidden"),s(".wpmud-box-title .wps-title-progress").addClass("hidden"),s("#wps-build-progress").addClass("hidden")):(s("#wps-build-error .wps-auth-message p").html("<p>"+snapshot_messages.snapshot_failed+"</p>"),s("#wps-build-error").removeClass("hidden"),s(".wpmud-box-title .wps-title-result").removeClass("hidden"),s(".wpmud-box-title .wps-title-progress").addClass("hidden"),s("#wps-build-progress").addClass("hidden"))},success:function(e){var a;if(s("#snapshot-progress-bar-container").find("#snapshot-item-table-"+j).find(".snapshot-button-abort").hide(),s("#snapshot-progress-bar-container").find("#snapshot-item-table-"+j).find(".wps-spinner").hide(),void 0!==e.errorStatus)if(!1===e.errorStatus){if(!1===t){if(void 0!==e.table_data){T=e.table_data;var o=parseInt(T.rows_start)+parseInt(T.rows_end);if(o>0?(a=Math.ceil(o/T.rows_total*100),s("#container.wps-page-builder #snapshot-item-table-"+T.table_name+" .wps-loading-status .wps-loading-bar span").width(a+"%"),s("#container.wps-page-builder #snapshot-item-table-"+T.table_name+" .wps-loading-status .wps-loading-number").html(a+"%")):(a=100,s("#container.wps-page-builder #snapshot-item-table-"+T.table_name+" .wps-loading-status .wps-loading-bar span").width(a+"%"),s("#container.wps-page-builder #snapshot-item-table-"+T.table_name+" .wps-loading-status .wps-loading-number").html(a+"%")),100==a){s("#container.wps-page-builder #snapshot-item-table-"+T.table_name+" .snapshot-button-abort").hide(),s("#container.wps-page-builder #snapshot-item-table-"+T.table_name+" .wps-spinner").hide(),s("#container.wps-page-builder #snapshot-item-table-"+T.table_name+" .wps-loading-status .wps-loading-bar .wps-loader").addClass("done"),w++;var r=Math.min(100,Math.round(100*w/m));s("#wps-build-progress .wps-total-status .wps-loading-number").html(r+"%"),s("#wps-build-progress .wps-total-status .wps-loading-bar span").width(r+"%")}}y("table",k)}}else s("#wps-build-error .wps-auth-message p").html(e.errorText),s("#wps-build-error").removeClass("hidden"),s(".wpmud-box-title .wps-title-result").removeClass("hidden"),s(".wpmud-box-title .wps-title-progress").addClass("hidden"),s("#wps-build-progress").addClass("hidden");else s("#wps-build-error .wps-auth-message p").html("<p>"+snapshot_messages.snapshot_failed+"</p>"),s("#wps-build-error").removeClass("hidden"),s(".wpmud-box-title .wps-title-result").removeClass("hidden"),s(".wpmud-box-title .wps-title-progress").addClass("hidden"),s("#wps-build-progress").addClass("hidden")}})}else if("file"==f){var S=parseInt(v),M=S+1;if(j=f,M>b.length)return void(b.length>0&&y("finish",0));var E=b[S];E=void 0!==(C=E)&&C.length?C.replace(/\\/g,"/").replace(/.*\//,""):C,s("#snapshot-item-"+j+" .snapshot-filename").html(": "+E),s("#snapshot-progress-bar-container #snapshot-item-file button.snapshot-button-abort").show(),s("#snapshot-progress-bar-container #snapshot-item-file button.snapshot-button-abort").on("click",function(){a()}),Q={action:"snapshot_restore_ajax",snapshot_action:f,item_key:o,item_data:g,file_data_idx:S,"snapshot-blog-id":h},e=s.ajax({type:"POST",url:ajaxurl,data:Q,timeout:6e5,dataType:"json",error:function(e,t,a){!1!==e.responseText&&""!==e.responseText?(s("#wps-build-error").removeClass("hidden").find(".wps-auth-message p").html(e.responseText),s(".wpmud-box-title .wps-title-result").removeClass("hidden"),s(".wpmud-box-title .wps-title-progress").addClass("hidden"),s("#wps-build-progress").addClass("hidden")):(s("#wps-build-error .wps-auth-message p").html("<p>"+snapshot_messages.snapshot_failed+"</p>"),s("#wps-build-error").removeClass("hidden"),s(".wpmud-box-title .wps-title-result").removeClass("hidden"),s(".wpmud-box-title .wps-title-progress").addClass("hidden"),s("#wps-build-progress").addClass("hidden"))},success:function(e){var a;if(s("#snapshot-progress-bar-container #snapshot-item-table-"+j+" .snapshot-button-abort").hide(),s("#snapshot-progress-bar-container #snapshot-item-table-"+j+" .wps-spinner").hide(),void 0!==e.errorStatus)if(!1===e.errorStatus){if(!1===t){if(void 0!==e.file_data){if(M<b.length)a=Math.ceil(M/b.length*100),s("#container.wps-page-builder #snapshot-item-"+j+" .wps-loading-status .wps-loading-bar span").width(a+"%"),s("#container.wps-page-builder #snapshot-item-"+j+" .wps-loading-status .wps-loading-number").html(a+"%");else{w++;var o=Math.min(100,Math.round(100*w/m));s("#wps-build-progress .wps-total-status .wps-loading-number").html(o+"%"),s("#wps-build-progress .wps-total-status .wps-loading-bar span").width(o+"%"),a=100,s("#container.wps-page-builder #snapshot-item-"+j+" .wps-loading-status .wps-loading-bar span").width(a+"%"),s("#container.wps-page-builder #snapshot-item-"+j+" .wps-loading-status .wps-loading-number").html(a+"%"),s("#container.wps-page-builder #snapshot-item-"+j+" .wps-loading-status .wps-loading-bar .wps-loader").addClass("done")}100===a&&(s("#snapshot-progress-bar-container #snapshot-item-"+j+" .snapshot-button-abort").hide(),s("#snapshot-progress-bar-container #snapshot-item-"+j+" .wps-spinner").hide(),s("#snapshot-item-"+j+" .snapshot-filename").html(""))}y("file",M)}}else s("#wps-build-error").removeClass("hidden").find(".wps-auth-message p").html(e.errorText),s(".wpmud-box-title .wps-title-result").removeClass("hidden"),s(".wpmud-box-title .wps-title-progress").addClass("hidden"),s("#wps-build-progress").addClass("hidden");else s("#wps-build-error").removeClass("hidden").find(".wps-auth-message p").html("<p>"+snapshot_messages.snapshot_failed+"</p>"),s(".wpmud-box-title .wps-title-result").removeClass("hidden"),s(".wpmud-box-title .wps-title-progress").addClass("hidden"),s("#wps-build-progress").addClass("hidden")}})}else"finish"==f&&(s("#container.wps-page-builder #snapshot-item-table-"+(j=f)+" .wps-loading-status .wps-loading-bar span").width("0%"),s("#container.wps-page-builder #snapshot-item-table-"+j+" .wps-loading-status").addClass("wps-spinner"),s("#container.wps-page-builder #snapshot-item-table-"+j+" .wps-loading-status .wps-loading-number").html("0%"),Q={action:"snapshot_restore_ajax",snapshot_action:f,item_key:o,item_data:g,"snapshot-blog-id":h,snapshot_restore_plugin:n,snapshot_restore_theme:i},e=s.ajax({type:"POST",url:ajaxurl,data:Q,dataType:"json",error:function(e,t,a){!1!==e.responseText&&""!==e.responseText?(s("#wps-build-error .wps-auth-message p").html(e.responseText),s("#wps-build-error").removeClass("hidden"),s(".wpmud-box-title .wps-title-result").removeClass("hidden"),s(".wpmud-box-title .wps-title-progress").addClass("hidden"),s("#wps-build-progress").addClass("hidden")):(s("#wps-build-error .wps-auth-message p").html("<p>"+snapshot_messages.snapshot_failed+"</p>"),s("#wps-build-error").removeClass("hidden"),s(".wpmud-box-title .wps-title-result").removeClass("hidden"),s(".wpmud-box-title .wps-title-progress").addClass("hidden"),s("#wps-build-progress").addClass("hidden"))},success:function(e){if(void 0!==e.errorStatus)if(!1===e.errorStatus){if(!1===t){w++;var a=Math.min(100,Math.round(100*w/m));s("#wps-build-progress .wps-total-status .wps-loading-number").html(a+"%"),s("#wps-build-progress .wps-total-status .wps-loading-bar span").width(a+"%");s("#container.wps-page-builder #wps-log-process-finish .wps-loading-status .wps-loading-bar span").width("100%"),s("#container.wps-page-builder #wps-log-process-finish .wps-loading-status .wps-loading-number").html("100%"),s("#container.wps-page-builder #wps-log-process-finish .wps-loading-status .wps-loading-bar .wps-loader").addClass("done"),s("#container.wps-page-builder #wps-log-process-finish .wps-loading-status").removeClass("wps-spinner"),s("#wps-build-success-view").attr("href",s("#wps-build-success .wps-auth-message.success").find("a").attr("href")),s("#wps-build-error").addClass("hidden"),s("#wps-build-progress").addClass("hidden"),void 0!==e.restore_admin_url&&s("a.restored-admin-url").attr("href",e.restore_admin_url),void 0!==e.restore_site_url&&s("a.restored-site-url").attr("href",e.restore_site_url),s("#wps-build-success").removeClass("hidden")}}else s("#wps-build-error .wps-auth-message p").html(e.errorText),s("#wps-build-error").removeClass("hidden"),s(".wpmud-box-title .wps-title-result").removeClass("hidden"),s(".wpmud-box-title .wps-title-progress").addClass("hidden"),s("#wps-build-progress").addClass("hidden");else s("#wps-build-error .wps-auth-message p").html("<p>"+snapshot_messages.snapshot_failed+"</p>"),s("#wps-build-error").removeClass("hidden"),s(".wpmud-box-title .wps-title-result").removeClass("hidden"),s(".wpmud-box-title .wps-title-progress").addClass("hidden"),s("#wps-build-progress").addClass("hidden")}}))}("init",0),!1})}}(jQuery),function(s){window.SS_PAGES.snapshot_page_snapshot_snapshots=function(){s(".wps-menu-dots").each(function(){var e=s(this),t=e.parent(".wps-menu"),a=s(".wps-menu").not(t);e.on("click",function(){a.removeClass("open"),t[t.hasClass("open")?"removeClass":"addClass"]("open")})}),s("#my-snapshot-all").on("change",function(){s('input[id^="my-snapshot"]').attr("checked",s(this).is(":checked"))}),s("#wps-snapshot-log").find(".wps-popup-close").on("click",function(e){e.preventDefault(),s("#wps-snapshot-log").removeClass("show")}),s("#wps-snapshot-log-view").on("click",function(e){e.preventDefault(),s("#wps-snapshot-log .wps-log-box").html(snapshot_messages.loading+"<br />"),s("#wps-snapshot-log").addClass("show");var t=tb_parseQuery(s("#wps-snapshot-log").attr("data-ajax-src")),a=0,o=setInterval(function(){if(s("#wps-snapshot-log").length&&s("#wps-snapshot-log").is(".show")){var e={action:"snapshot_view_log_ajax","snapshot-item":t["snapshot-item"],"snapshot-data-item":t["snapshot-data-item"],"snapshot-log-position":a};snapshot_ajax_hdl_xhr=jQuery.ajax({type:"POST",url:ajaxurl,cache:!1,data:e,dataType:"json",error:function(s,e,t){clearInterval(o)},success:function(e){void 0!==e&&void 0!==e.payload&&(0===a?s("#wps-snapshot-log .wps-log-box").html(e.payload):s("#wps-snapshot-log .wps-log-box").append(e.payload),"1"==t.live&&s("#wps-snapshot-log").length&&s("#wps-snapshot-log .wps-log-box").scrollTop(s("#wps-snapshot-log .wps-log-box")[0].scrollHeight)),void 0!==e&&void 0!==e.position&&a!=e.position&&(a=e.position),0===e.payload.length&&clearInterval(o)}})}else clearInterval(o)},1e3)}),s("body").is(".snapshot_page_snapshot_snapshot_create")||window.SS_PAGES.snapshot_page_snapshot_snapshot_create()}}(jQuery),function(s){SS_UTILS.openModal=function(e,t,a,o){var r=s(s("#ss-modal-template").html());r.find(".wpmud-box-title > h3").html(e),r.find(".wpmud-box-content").html(t),s("#wpbody-content").append(r),"function"==typeof a&&a(),r.fadeIn(),r.on("click",".wpmud-box-title > .close",function(){r.fadeOut(),setTimeout(function(){r.remove(),"function"==typeof o&&o()},400)})}}(jQuery);